USE s17guest45;
GO

CREATE TABLE PERSON(
	PERSON_ID INT IDENTITY,
	PERSON_FIRST_NAME NVARCHAR(50) NOT NULL,
	PERSON_LAST_NAME NVARCHAR(50) NOT NULL,
	PERSON_STREET NVARCHAR(100),
	PERSON_CITY NVARCHAR(100),
	PERSON_ZIP NVARCHAR(20),
	PERSON_STATE NVARCHAR(50),
	PERSON_EMAIL NVARCHAR(150),
	PRIMARY KEY (PERSON_ID)
);

CREATE TABLE ROLE(
	ROLE_ID SMALLINT IDENTITY,
	ROLE_NAME NVARCHAR(100) NOT NULL,
	PRIMARY KEY (ROLE_ID)
);

CREATE TABLE PERSON_ROLE(
	PERSON_ROLE_ID SMALLINT IDENTITY NOT NULL,
	PERSON_ID INT NOT NULL,
	ROLE_ID SMALLINT NOT NULL,
	PRIMARY KEY (PERSON_ROLE_ID),
	FOREIGN KEY (PERSON_ID) REFERENCES PERSON(PERSON_ID),
	FOREIGN KEY (ROLE_ID) REFERENCES ROLE(ROLE_ID),
	UNIQUE (PERSON_ID, ROLE_ID)
);

CREATE TABLE EVENT(
	EVENT_ID SMALLINT IDENTITY NOT NULL,
	EVENT_NAME NVARCHAR(100) NOT NULL,
	EVENT_DATE NVARCHAR(100) NOT NULL,
	EVENT_CITY NVARCHAR(100) NOT NULL,
	EVENT_REGION NVARCHAR(100) NOT NULL,
	PRIMARY KEY(EVENT_ID)
);

CREATE TABLE TABLE_OF_EVENT(
	TABLE_ID SMALLINT IDENTITY NOT NULL,
	NUMBER_OF_TABLE SMALLINT NOT NULL,
	PRIMARY KEY (TABLE_ID)
);

CREATE TABLE SPONSOR(
	SPONSOR_ID SMALLINT IDENTITY,
	SPONSOR_NAME NVARCHAR(100) NOT NULL,
	SPONSOR_LEVEL NVARCHAR(50) NOT NULL
	PRIMARY KEY(SPONSOR_ID)
);

CREATE TABLE ROOM(
	ROOM_ID INT IDENTITY NOT NULL,
	ROOM_NUMBER NVARCHAR(50),
	PRIMARY KEY (ROOM_ID)
);

CREATE TABLE TRACK(
	TRACK_ID INT IDENTITY NOT NULL,
	TRACK_NAME NVARCHAR(100) NOT NULL UNIQUE,
	PRIMARY KEY(TRACK_ID)
);

CREATE TABLE PRESENTATION(
	PRESENTATION_ID INT IDENTITY NOT NULL,
	PRESENTATION_TITLE NVARCHAR(100) NOT NULL,
	PRESENTATION_LEVEL NVARCHAR(50),
	PRESENTATION_LOCATION NVARCHAR(100),
	PRIMARY KEY (PRESENTATION_ID),
);

CREATE TABLE SCHEDULE(
	SCHEDULE_ID INT IDENTITY NOT NULL,
	SCHEDULE_TIME NVARCHAR(100) NOT NULL,
	PRESENTATION_ID INT NOT NULL UNIQUE,
	ROOM_ID INT NOT NULL,
	PRIMARY KEY (SCHEDULE_ID),
	FOREIGN KEY (PRESENTATION_ID) REFERENCES PRESENTATION(PRESENTATION_ID),
	FOREIGN KEY (ROOM_ID) REFERENCES ROOM(ROOM_ID)
);

CREATE TABLE TRACK_PRESENTATION(
	TRACK_PRESENTATION_ID INT IDENTITY NOT NULL,
	TRACK_ID INT NOT NULL,
	PRESENTATION_ID INT NOT NULL,
	PRIMARY KEY(TRACK_PRESENTATION_ID),
	FOREIGN KEY (TRACK_ID) REFERENCES TRACK(TRACK_ID),
	FOREIGN KEY (PRESENTATION_ID) REFERENCES PRESENTATION(PRESENTATION_ID),
	UNIQUE (TRACK_ID, PRESENTATION_ID)
);

CREATE TABLE SCHEDULE_EVENT(
	SCHEDULE_EVENT_ID INT IDENTITY NOT NULL,
	EVENT_ID SMALLINT NOT NULL,
	SCHEDULE_ID INT NOT NULL,
	PRIMARY KEY (SCHEDULE_EVENT_ID),
	FOREIGN KEY (SCHEDULE_ID) REFERENCES SCHEDULE(SCHEDULE_ID),
	FOREIGN KEY (EVENT_ID) REFERENCES EVENT(EVENT_ID),
	UNIQUE (SCHEDULE_ID, EVENT_ID)
);

CREATE TABLE PRESENTER_PRESENTATION(
	PRESENTER_PRESENTATION_ID INT IDENTITY NOT NULL,
	PRESENTER_ID INT NOT NULL,
	PRESENTATION_ID INT NOT NULL,
	PRIMARY KEY (PRESENTER_PRESENTATION_ID),
	FOREIGN KEY (PRESENTER_ID) REFERENCES PERSON(PERSON_ID),
	FOREIGN KEY (PRESENTATION_ID) REFERENCES PRESENTATION(PRESENTATION_ID),
	UNIQUE (PRESENTER_ID, PRESENTATION_ID)
);


